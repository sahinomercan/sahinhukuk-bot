
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>ŞahinHukuk Chatbot</title>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#fff; }
    #chat-container { display:flex; flex-direction:column; height:100vh; }
    #messages { flex:1; padding:10px; overflow-y:auto; }
    .msg { margin:5px 0; padding:8px; border-radius:5px; max-width:80%; }
    .user { align-self:flex-end; background:#0078D4; color:#fff; }
    .bot { align-self:flex-start; background:#f1f1f1; color:#000; }
    #input-area { display:flex; padding:10px; border-top:1px solid #ddd; }
    #input { flex:1; padding:8px; border:1px solid #ccc; border-radius:4px; }
    #send { margin-left:8px; padding:8px 12px; background:#0078D4; color:#fff; border:none; border-radius:4px; cursor:pointer;}
    #close { position:absolute; top:10px; right:10px; cursor:pointer; color:#888; font-size:18px; }
  </style>
</head>
<body>

<div id="chat-container">
  <div id="close">✖</div>
  <div id="messages"></div>
  <div id="input-area">
    <input type="text" id="input" placeholder="Sorunuzu yazın..." />
    <button id="send">Gönder</button>
  </div>
</div>

<script>
  const workerUrl = 'https://sahinhukuk-chatbot.cannnsahinnn.workers.dev';
  const chat = document.getElementById('chat-container');
  document.getElementById('close').onclick = () => window.parent.postMessage('closeChat','*');

  async function sendMessage() {
    const input = document.getElementById('input');
    if (!input.value.trim()) return;
    addMessage(input.value, 'user'); 
    const userMsg = input.value;
    input.value = '';
    try {
      const res = await fetch(workerUrl, {
        method:'POST', headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify({ message: userMsg })
      });
      const data = await res.json();
      if (data.reply) addMessage(data.reply,'bot');
      else addMessage('Üzgünüm, bir hata oldu.','bot');
    } catch(e) {
      addMessage('Sunucuya ulaşılamadı.','bot');
    }
  }

  function addMessage(text,cls){
    const d = document.createElement('div');
    d.className = 'msg '+ cls;
    d.textContent = text;
    document.getElementById('messages').appendChild(d);
    d.scrollIntoView();
  }

  document.getElementById('send').onclick = sendMessage;
  document.getElementById('input').onkeydown = e => e.key==='Enter' && sendMessage();
</script>
</body>
</html>
